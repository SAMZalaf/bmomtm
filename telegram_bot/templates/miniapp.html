<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>ุฅุฏุงุฑุฉ ุงูุฃุฒุฑุงุฑ ุงูุฏููุงููููุฉ</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <link rel="stylesheet" href="/static/css/miniapp.css">
</head>
<body>
    <div id="app">
        <header class="header">
            <h1>๐๏ธ ุฅุฏุงุฑุฉ ุงูุฃุฒุฑุงุฑ</h1>
            <div class="header-actions">
                <button class="btn btn-icon" onclick="refreshTree()" title="ุชุญุฏูุซ">๐</button>
                <button class="btn btn-icon" onclick="showExportImport()" title="ุชุตุฏูุฑ/ุงุณุชูุฑุงุฏ">๐ฆ</button>
            </div>
        </header>

        <nav class="breadcrumb" id="breadcrumb">
            <span class="breadcrumb-item active" onclick="goToRoot()">๐ ุงูุฑุฆูุณูุฉ</span>
        </nav>

        <div class="content">
            <div class="tree-container" id="treeContainer">
                <div class="loading" id="loading">
                    <div class="spinner"></div>
                    <p>ุฌุงุฑู ุงูุชุญููู...</p>
                </div>
                <div class="button-list" id="buttonList"></div>
            </div>
        </div>

        <button class="fab" onclick="showAddButtonModal()" title="ุฅุถุงูุฉ ุฒุฑ ุฌุฏูุฏ">โ</button>
    </div>

    <!-- Modal: ุฅุถุงูุฉ/ุชุนุฏูู ุฒุฑ -->
    <div class="modal" id="buttonModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2 id="modalTitle">ุฅุถุงูุฉ ุฒุฑ ุฌุฏูุฏ</h2>
                <button class="btn-close" onclick="closeModal('buttonModal')">&times;</button>
            </div>
            <form id="buttonForm" onsubmit="saveButton(event)">
                <input type="hidden" id="buttonId">
                <input type="hidden" id="parentId">
                
                <div class="form-group">
                    <label for="buttonKey">ุงูููุชุงุญ (ุจุงูุฅูุฌููุฒูุฉ)</label>
                    <input type="text" id="buttonKey" required pattern="[a-z0-9_]+" 
                           placeholder="ูุซุงู: static_monthly" title="ุฃุญุฑู ุตุบูุฑุฉ ูุฃุฑูุงู ู _ ููุท">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="textAr">ุงููุต ุจุงูุนุฑุจูุฉ</label>
                        <input type="text" id="textAr" required placeholder="๐ ุณุชุงุชูู ุดูุฑู">
                    </div>
                    <div class="form-group">
                        <label for="textEn">ุงููุต ุจุงูุฅูุฌููุฒูุฉ</label>
                        <input type="text" id="textEn" required placeholder="๐ Static Monthly">
                    </div>
                </div>

                <div class="form-group">
                    <label for="icon">ุงูุฃููููุฉ (ุงุฎุชูุงุฑู)</label>
                    <input type="text" id="icon" placeholder="๐">
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="buttonType">ููุน ุงูุฒุฑ</label>
                        <select id="buttonType" onchange="toggleServiceFields()">
                            <option value="menu">ูุงุฆูุฉ (ูู ุฃุฒุฑุงุฑ ูุฑุนูุฉ)</option>
                            <option value="service">ุฎุฏูุฉ ููุงุฆูุฉ</option>
                        </select>
                    </div>
                    <div class="form-group">
                        <label for="isEnabled">ุงูุญุงูุฉ</label>
                        <select id="isEnabled">
                            <option value="1">ููุนูู โ</option>
                            <option value="0">ูุนุทูู โ</option>
                        </select>
                    </div>
                </div>

                <div id="serviceFields" class="service-fields hidden">
                    <div class="form-row">
                        <div class="form-group">
                            <label for="price">ุงูุณุนุฑ ($)</label>
                            <input type="number" id="price" step="0.01" min="0" value="0" placeholder="4.00">
                        </div>
                        <div class="form-group">
                            <label for="defaultQuantity">ุงููููุฉ ุงูุงูุชุฑุงุถูุฉ</label>
                            <input type="number" id="defaultQuantity" min="1" value="1">
                        </div>
                    </div>
                    <div class="form-group">
                        <label class="checkbox-label">
                            <input type="checkbox" id="askQuantity">
                            <span>ุณุคุงู ุงูุนููู ุนู ุงููููุฉ</span>
                        </label>
                    </div>
                </div>

                <div class="form-row">
                    <div class="form-group">
                        <label for="messageAr">ุฑุณุงูุฉ ุจุงูุนุฑุจูุฉ</label>
                        <textarea id="messageAr" rows="2" placeholder="ุงุฎุชุฑ ุงูุฎุฏูุฉ ุงููุทููุจุฉ"></textarea>
                    </div>
                    <div class="form-group">
                        <label for="messageEn">ุฑุณุงูุฉ ุจุงูุฅูุฌููุฒูุฉ</label>
                        <textarea id="messageEn" rows="2" placeholder="Choose your service"></textarea>
                    </div>
                </div>

                <div class="form-actions">
                    <button type="button" class="btn btn-secondary" onclick="closeModal('buttonModal')">ุฅูุบุงุก</button>
                    <button type="submit" class="btn btn-primary">๐พ ุญูุธ</button>
                </div>
            </form>
        </div>
    </div>

    <!-- Modal: ุชุตุฏูุฑ/ุงุณุชูุฑุงุฏ -->
    <div class="modal" id="exportImportModal">
        <div class="modal-content">
            <div class="modal-header">
                <h2>๐ฆ ุชุตุฏูุฑ / ุงุณุชูุฑุงุฏ</h2>
                <button class="btn-close" onclick="closeModal('exportImportModal')">&times;</button>
            </div>
            <div class="modal-body">
                <div class="export-import-tabs">
                    <button class="tab-btn active" onclick="switchTab('export')">ุชุตุฏูุฑ</button>
                    <button class="tab-btn" onclick="switchTab('import')">ุงุณุชูุฑุงุฏ</button>
                </div>
                <div id="exportTab" class="tab-content active">
                    <p>ูู ุจุชุตุฏูุฑ ุฌููุน ุงูุฃุฒุฑุงุฑ ูููู JSON ูููุณุฎ ุงูุงุญุชูุงุทู</p>
                    <button class="btn btn-primary" onclick="exportTree()">๐ฅ ุชุตุฏูุฑ ุงูุฃุฒุฑุงุฑ</button>
                    <textarea id="exportData" class="export-textarea" readonly placeholder="ุณูุธูุฑ ููุง ูุญุชูู ุงูุชุตุฏูุฑ..."></textarea>
                </div>
                <div id="importTab" class="tab-content">
                    <p>โ๏ธ ุชุญุฐูุฑ: ุงูุงุณุชูุฑุงุฏ ุณูุญุฐู ุฌููุน ุงูุฃุฒุฑุงุฑ ุงูุญุงููุฉ!</p>
                    <textarea id="importData" class="export-textarea" placeholder="ุงูุตู ููุง ูุญุชูู JSON ููุงุณุชูุฑุงุฏ..."></textarea>
                    <button class="btn btn-danger" onclick="importTree()">๐ค ุงุณุชูุฑุงุฏ ุงูุฃุฒุฑุงุฑ</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal: ุชุฃููุฏ ุงูุญุฐู -->
    <div class="modal" id="deleteModal">
        <div class="modal-content modal-small">
            <div class="modal-header">
                <h2>โ๏ธ ุชุฃููุฏ ุงูุญุฐู</h2>
            </div>
            <div class="modal-body">
                <p id="deleteMessage">ูู ุฃูุช ูุชุฃูุฏ ูู ุญุฐู ูุฐุง ุงูุฒุฑ ูุฌููุน ุฃุจูุงุฆูุ</p>
            </div>
            <div class="form-actions">
                <button class="btn btn-secondary" onclick="closeModal('deleteModal')">ุฅูุบุงุก</button>
                <button class="btn btn-danger" onclick="confirmDelete()">๐๏ธ ุญุฐู</button>
            </div>
        </div>
    </div>

    <!-- Toast notifications -->
    <div class="toast-container" id="toastContainer"></div>

    <script src="/static/js/miniapp.js"></script>
</body>
</html>
